<div class='modal-header'>
  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
  <h4 class='modal-title'>Acadamic Results</h4>
</div>

<div class='modal-body form-horizontal'>
  <p class="text-black">
    Name : <span class="text-blue text-bold"><%= @student.name %></span>
    Roll Number : <span class="text-blue text-bold"><%= @student.roll_number %></span>
    Registration Number : <span class="text-blue text-bold"><%= @student.registration_number %></span>
  </p>
  <div class='ibox-content'>
    <div class="full-height-scroll">
      <div class='table-responsive'>
        <% @exam_marks.each do |exam_id, marks| %>
          <div class="panel panel-success">
            <div class="panel-heading">
              <%= @exams[exam_id] %>
            </div>
            <div class="panel-body">
              <p class="text-black">
                Class : <span class="text-blue text-bold"><%= marks.first.klass.name %></span>
                Section : <span class="text-blue text-bold"><%= marks.first.section.name %></span>
              </p>

              <table class='table table-striped table-bordered'>
                <thead>
                  <tr>
                    <th>Subject</th>
                    <th>Obtained</th>
                    <th>Marks %</th>
                    <th>Subject Average</th>
                    <th>Total</th>
                    <th>Passing</th>
                    <th>Comment</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <% marks.each do |mark| %>
                    <tr>
                      <td><%= mark.subject.name %></td>
                      <td><%= mark.obtained %></td>
                      <td><%= calculate_percentage(mark.obtained, mark.total) %></td>
                      <td><%= display_collective_average(mark.subject_id, mark.term_id, exam_id, @subject_marks) %></td>
                      <td><%= mark.total %></td>
                      <td><%= mark.passing_marks %></td>
                      <td><%= mark.comment %></td>
                      <td><%= mark.display_status %></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
              <p class="text-black">
                Total Marks : <span class="text-red text-bold"><%= marks.sum(&:total) %></span>
                Obtained Marks : <span class="text-red text-bold"><%= marks.sum(&:obtained) %></span>
                Marks Percentage : <span class="text-red text-bold"><%= calculate_percentage(marks.sum(&:obtained), marks.sum(&:total)) %></span>
              </p>

              <p class="text-black">
                Class Average : <span class="text-red text-bold"><%= display_collective_average(marks.first.klass_id, marks.first.term_id, exam_id, @klass_marks) %></span>
                Section Average : <span class="text-red text-bold"><%= display_collective_average(marks.first.section_id, marks.first.term_id, exam_id, @section_marks) %></span></p>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class='clearfix'></div>
</div>

<div class='modal-footer'>
  <div class='col-md-12 text-center'>
    <%= submit_tag 'Print', class: 'btn btn-primary' %>
  </div>
</div>

