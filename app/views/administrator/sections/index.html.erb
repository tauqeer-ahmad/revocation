<div class="row wrapper border-bottom white-bg page-heading">
  <div class="col-lg-10">
    <h2>Manage class sections for Term <%= current_term.name %></h2>
    <ol class="breadcrumb">
      <li>
        <%= link_to "Home", root_path %>
      </li>
      <li>
        <%= link_to "Terms", administrator_terms_path %>
      </li>
      <li class="active">
        <strong>Term Classes</strong>
      </li>
    </ol>
  </div>
  <div class="col-lg-2">
  </div>
</div>

<div class="row">
  <div class="col-lg-12">
    <div class="wrapper wrapper-content animate fadeInUp">
      <div class="row">
        <div class="tabs-container">
          <div class="tabs-left">
            <ul class="nav nav-tabs">
              <% @klasses.each_with_index do |klass, index| %>
                <li class='<%= "active" if index == 0 %>'>
                  <%= link_to klass.name, "#tab-#{klass.id}", data: { toggle: 'tab' }, aria: { expanded: true } %>
                </li>
              <% end %>
            </ul>

            <div class="tab-content">
              <% @klasses.each_with_index do |klass, index| %>
                <% sections = @sections.where(klass_id: klass.id) %>

                <div id='tab-<%= klass.id %>' class="tab-pane <%= "active" if index == 0 %>">
                  <div class="panel-body">
                    <div class="tab-tools m-b-lg">
                      <h3 class='pull-left'>
                        Sections of class <strong><%= klass.name %></strong> for term <strong><%= current_term.name %> <%= current_term.display_term_duration %></strong>
                      </h3>

                      <%= link_to 'Add a new section', new_administrator_klass_section_path(klass), class: 'btn btn-primary btn-outline btn-sm' %>
                    </div>

                    <% if sections.present? %>
                      <table class='table small m-b-xs'>
                        <thead>
                          <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Nickname</th>
                            <th>Incharge</th>
                            <th>Subjects</th>
                            <th>Actions</th>
                          </tr>
                        </thead>

                        <tbody>
                          <% @sections.where(klass_id: klass.id).each_with_index do |section, index| %>
                            <tr>
                              <td><%= index + 1 %></td>
                              <td><%= section.name %></td>
                              <td><%= section.nickname %></td>
                              <td><%= section.incharge_name %></td>
                              <td><%= section.display_subjects_count %></td>
                              <td>
                                <%= link_to administrator_klass_section_path(klass, section), class: "btn btn-success dim btn-outline btn-xs" do %>
                                  <i class="fa fa-eye"></i>
                                <% end %>
                                 <%= link_to edit_administrator_klass_section_path(klass, section), class: "btn btn-info btn-outline dim btn-xs" do %>
                                  <i class="fa fa-pencil-square-o"></i>
                                <% end %>
                                 <%= link_to administrator_klass_section_path(klass, section), method: :delete, class: "btn btn-danger btn-outline dim btn-xs" do %>
                                  <i class="fa fa-trash-o"></i>
                                <% end %>
                                <%= link_to administrator_section_students_path(section), class: "btn btn-success btn-outline btn-xs m-l-lg" do %>
                                  <i class="fa fa-users"></i> Manage Students
                                <% end %>
                                <%= link_to administrator_section_timetables_path(section), class: "btn btn-info btn-outline btn-xs" do %>
                                  <i class="fa fa-calendar"></i> Manage TimeTable
                                <% end %>
                              </td>
                            </tr>
                          <% end %>
                        </tbody>
                      </table>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
